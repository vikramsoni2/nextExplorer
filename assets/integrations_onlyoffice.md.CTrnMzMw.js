import{_ as t,c as o,o as i,ag as a}from"./chunks/framework.Clp4v-ho.js";const f=JSON.parse('{"title":"ONLYOFFICE Integration","description":"","frontmatter":{},"headers":[],"relativePath":"integrations/onlyoffice.md","filePath":"integrations/onlyoffice.md"}'),n={name:"integrations/onlyoffice.md"};function r(s,e,d,c,l,h){return i(),o("div",null,[...e[0]||(e[0]=[a('<h1 id="onlyoffice-integration" tabindex="-1">ONLYOFFICE Integration <a class="header-anchor" href="#onlyoffice-integration" aria-label="Permalink to &quot;ONLYOFFICE Integration&quot;">​</a></h1><p>Use ONLYOFFICE Document Server to edit office files (DOCX, XLSX, PPTX, ODT, ODS, ODP) from within nextExplorer. The integration relies on server-to-server API calls and a shared JWT secret.</p><h2 id="environment-variables" tabindex="-1">Environment variables <a class="header-anchor" href="#environment-variables" aria-label="Permalink to &quot;Environment variables&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Variable</th><th>Required?</th><th>Description</th></tr></thead><tbody><tr><td><code>ONLYOFFICE_URL</code></td><td>Yes</td><td>Public URL of your Document Server (e.g., <code>https://office.example.com</code>).</td></tr><tr><td><code>PUBLIC_URL</code></td><td>Yes</td><td>nextExplorer’s public URL so ONLYOFFICE knows where to download files and post callbacks.</td></tr><tr><td><code>ONLYOFFICE_SECRET</code></td><td>Yes</td><td>JWT secret shared between nextExplorer and ONLYOFFICE for signing requests/responses.</td></tr><tr><td><code>ONLYOFFICE_LANG</code></td><td>No (default <code>en</code>)</td><td>Language code for the editor UI.</td></tr><tr><td><code>ONLYOFFICE_FORCE_SAVE</code></td><td>No</td><td>When true, users must use the editor’s Save button rather than relying on autosave.</td></tr><tr><td><code>ONLYOFFICE_FILE_EXTENSIONS</code></td><td>No</td><td>Comma-separated list of extensions you want to surface beyond the defaults.</td></tr></tbody></table><h2 id="how-it-works" tabindex="-1">How it works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How it works&quot;">​</a></h2><ol><li>Opening a compatible file triggers a call to <code>/api/onlyoffice/config</code>, which returns editor configuration and a signed <code>config.token</code> when <code>ONLYOFFICE_SECRET</code> is set.</li><li>ONLYOFFICE fetches the file through <code>/api/onlyoffice/file?path=...</code> with an <code>Authorization: Bearer &lt;config.token&gt;</code> header.</li><li>After editing, ONLYOFFICE posts to <code>/api/onlyoffice/callback?path=...</code>, again authorized with the token; nextExplorer saves the changes automatically.</li></ol><h2 id="security-notes" tabindex="-1">Security notes <a class="header-anchor" href="#security-notes" aria-label="Permalink to &quot;Security notes&quot;">​</a></h2><ul><li>Tokens are signed with HS256 using <code>ONLYOFFICE_SECRET</code>. Keep this secret in sync with the Document Server’s <code>services.CoAuthoring.secret</code> (<code>local.json</code>).</li><li>To inspect the secret, run inside the Document Server container:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;.services.CoAuthoring.secret.session.string&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/onlyoffice/documentserver/local.json</span></span></code></pre></div></li><li>Disable ONLYOFFICE JWT on the Document Server only if you completely trust the network; otherwise, mismatched tokens result in “document security token is not correctly configured.”</li></ul>',8)])])}const p=t(n,[["render",r]]);export{f as __pageData,p as default};
