import{_ as o,c,o as t,ae as i}from"./chunks/framework.BefrkHQ3.js";const p=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"onlyoffice.md","filePath":"onlyoffice.md"}'),n={name:"onlyoffice.md"};function r(l,e,s,d,a,f){return t(),c("div",null,[...e[0]||(e[0]=[i("<p>ONLYOFFICE Integration</p><p>This app integrates ONLYOFFICE Document Server for editing Office files (docx, xlsx, pptx, odt, ods, odp, etc.). Double‑clicking a supported file opens it in an embedded editor, with changes saved back to storage.</p><p>Server configuration</p><ul><li>Set environment variables on the backend: <ul><li><code>ONLYOFFICE_URL</code> – public URL of your Document Server, e.g. <code>https://office.vsoni.com</code>.</li><li><code>PUBLIC_URL</code> – public base URL of this app, e.g. <code>https://files.example.com</code>. The Document Server fetches files and posts callbacks to this origin.</li><li><code>ONLYOFFICE_SECRET</code> – Document Server JWT secret (must match DS <code>services.CoAuthoring.secret</code>). Used to sign <code>config.token</code> and verify DS requests.</li><li><code>ONLYOFFICE_LANG</code> – language code for the editor UI (e.g. <code>en</code>, <code>fr</code>). Defaults to <code>en</code>.</li></ul></li></ul><p>Routes</p><ul><li><code>POST /api/onlyoffice/config</code> – returns editor config for a file (requires user session). When <code>ONLYOFFICE_SECRET</code> is set, responds with <code>config.token</code> signed with HS256.</li><li><code>GET /api/onlyoffice/file?path</code> – Document Server downloads the file. Expects <code>Authorization: Bearer &lt;config.token&gt;</code> (or <code>?token=</code>).</li><li><code>POST /api/onlyoffice/callback?path</code> – Document Server posts save callbacks. Expects <code>Authorization: Bearer &lt;config.token&gt;</code> (or <code>?token=</code>).</li></ul><p>Notes</p><ul><li>Ensure the Document Server can reach <code>PUBLIC_URL</code> over the network.</li><li>If you see “document security token is not correctly configured”, set <code>ONLYOFFICE_SECRET</code> to the exact DS secret or disable JWT on the DS.</li></ul><p>Finding the DS JWT secret</p><ul><li>Docker shell into the DS container, then run one of the following (paths can vary by build): <ul><li><code>jq -r &#39;.services.CoAuthoring.secret.session.string&#39; /etc/onlyoffice/documentserver/local.json</code></li><li>or <code>jq -r &#39;.services.CoAuthoring.secret&#39; /etc/onlyoffice/documentserver/local.json</code></li></ul></li><li>Check if JWT is enabled: <code>jq -r &#39;.services.CoAuthoring.token.enable&#39; /etc/onlyoffice/documentserver/local.json</code></li></ul>",10)])])}const h=o(n,[["render",r]]);export{p as __pageData,h as default};
