import{_ as o,c as t,o as a,ag as i}from"./chunks/framework.Clp4v-ho.js";const p=JSON.parse('{"title":"OIDC Integration","description":"","frontmatter":{},"headers":[],"relativePath":"integrations/oidc.md","filePath":"integrations/oidc.md"}'),n={name:"integrations/oidc.md"};function d(r,e,c,l,s,h){return a(),t("div",null,[...e[0]||(e[0]=[i('<h1 id="oidc-integration" tabindex="-1">OIDC Integration <a class="header-anchor" href="#oidc-integration" aria-label="Permalink to &quot;OIDC Integration&quot;">​</a></h1><p>nextExplorer uses Express OpenID Connect (EOC) to federate authentication with external providers. Configure these variables and your IdP once, and the app exposes <code>/login</code>, <code>/callback</code>, and <code>/logout</code> to manage the flow.</p><h2 id="environment-variables-see-backend-config-env-js" tabindex="-1">Environment variables (see <code>backend/config/env.js</code>) <a class="header-anchor" href="#environment-variables-see-backend-config-env-js" aria-label="Permalink to &quot;Environment variables (see `backend/config/env.js`)&quot;">​</a></h2><ul><li><code>OIDC_ENABLED=true</code> enables the middleware.</li><li><code>OIDC_ISSUER</code> points to the IdP discovery URL (e.g., Keycloak realm or Authentik application base).</li><li><code>OIDC_CLIENT_ID</code> and <code>OIDC_CLIENT_SECRET</code> store client credentials.</li><li><code>OIDC_SCOPES</code> defaults to <code>openid profile email</code>; add <code>groups</code> if you want nextExplorer to inspect group claims.</li><li><code>OIDC_ADMIN_GROUPS</code> contains comma/space-separated group names that grant the admin role when present in <code>groups</code>, <code>roles</code>, or <code>entitlements</code> claims.</li><li>Optional overrides: <code>OIDC_AUTHORIZATION_URL</code>, <code>OIDC_TOKEN_URL</code>, <code>OIDC_USERINFO_URL</code>, and an explicit <code>OIDC_CALLBACK_URL</code> (defaults to <code>${PUBLIC_URL}/callback</code>).</li></ul><h2 id="flow-overview" tabindex="-1">Flow overview <a class="header-anchor" href="#flow-overview" aria-label="Permalink to &quot;Flow overview&quot;">​</a></h2><ol><li>A user clicks “Continue with Single Sign-On” on the login page.</li><li>The app redirects to <code>${OIDC_AUTHORIZATION_URL}</code> or the issuer discovery endpoint.</li><li>After IdP authentication, the callback (<code>/callback</code>) is invoked, sessions are established, and the user lands back in the workspace.</li><li>Logout routes (<code>/logout</code>) tear down the session; IdP logout is not invoked automatically but can be triggered via your IdP UI if needed.</li></ol><h2 id="admin-elevation" tabindex="-1">Admin elevation <a class="header-anchor" href="#admin-elevation" aria-label="Permalink to &quot;Admin elevation&quot;">​</a></h2><ul><li>nextExplorer inspects the <code>groups</code>, <code>roles</code>, and <code>entitlements</code> claims returned by the IdP.</li><li>If any entry matches <code>OIDC_ADMIN_GROUPS</code> (case-insensitive), the user is promoted to admin.</li><li>Without a match, the user receives the standard <code>user</code> role and only sees non-admin settings.</li></ul><h2 id="common-troubleshooting" tabindex="-1">Common troubleshooting <a class="header-anchor" href="#common-troubleshooting" aria-label="Permalink to &quot;Common troubleshooting&quot;">​</a></h2><ul><li><strong>Invalid redirect URI</strong>: Ensure your IdP’s redirect URI matches <code>${PUBLIC_URL}/callback</code> or the explicitly configured <code>OIDC_CALLBACK_URL</code>.</li><li><strong>Sessions drop after restart</strong>: Supply a stable <code>SESSION_SECRET</code> instead of letting the app generate one dynamically.</li><li><strong>Not an admin after login</strong>: Verify the IdP includes the expected group claim (e.g., <code>groups</code> scope) and that <code>OIDC_ADMIN_GROUPS</code> contains the group name exactly.</li><li><strong>Cookies flagged Insecure</strong>: Run the app over HTTPS (<code>PUBLIC_URL</code> must use <code>https</code>) and confirm your proxy forwards <code>X-Forwarded-Proto</code>/<code>Host</code> headers (see the Reverse Proxy guide).</li></ul>',10)])])}const g=o(n,[["render",d]]);export{p as __pageData,g as default};
