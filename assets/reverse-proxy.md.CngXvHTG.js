import{_ as s,c as i,o as a,ae as n}from"./chunks/framework.BefrkHQ3.js";const k=JSON.parse('{"title":"Running Behind a Reverse Proxy (e.g., Nginx Proxy Manager)","description":"","frontmatter":{},"headers":[],"relativePath":"reverse-proxy.md","filePath":"reverse-proxy.md"}'),t={name:"reverse-proxy.md"};function l(o,e,r,p,d,c){return a(),i("div",null,[...e[0]||(e[0]=[n(`<h1 id="running-behind-a-reverse-proxy-e-g-nginx-proxy-manager" tabindex="-1">Running Behind a Reverse Proxy (e.g., Nginx Proxy Manager) <a class="header-anchor" href="#running-behind-a-reverse-proxy-e-g-nginx-proxy-manager" aria-label="Permalink to &quot;Running Behind a Reverse Proxy (e.g., Nginx Proxy Manager)&quot;">​</a></h1><p>When placing nextExplorer behind a reverse proxy and a custom domain, set a single environment variable and the app will derive everything it needs:</p><ul><li><code>PUBLIC_URL</code> – the fully-qualified public URL for your app (no trailing slash). Example: <code>https://files.example.com</code></li></ul><p>What it controls:</p><ul><li>CORS allowed origin defaults to the origin of <code>PUBLIC_URL</code> unless you explicitly set <code>CORS_ORIGINS</code>.</li><li>OIDC callback URL defaults to <code>PUBLIC_URL + /callback</code> unless you explicitly set <code>OIDC_CALLBACK_URL</code>.</li><li>Express configures a safe <code>trust proxy</code> default when <code>PUBLIC_URL</code> is provided (can be overridden with <code>TRUST_PROXY</code>).</li></ul><p>Compose example:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  nextexplorer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nxzai/explorer:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NODE_ENV=production</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PUBLIC_URL=https://files.example.com</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Optional: override or add more CORS origins</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # - CORS_ORIGINS=https://files.example.com,https://admin.example.com</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Optional: override OIDC callback if you need a non-default path</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # - OIDC_CALLBACK_URL=https://files.example.com/custom/callback</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;3000:3000&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # or run without publishing and let the proxy connect the container network</span></span></code></pre></div><p>Nginx Proxy Manager tips:</p><ul><li>Point your domain to the container’s internal port 3000.</li><li>Enable Websockets and preserve <code>X-Forwarded-*</code> headers (enabled by default in NPM).</li><li>Terminate TLS at the proxy; nextExplorer will treat cookies as Secure in production.</li></ul><h3 id="trust-proxy-settings" tabindex="-1">Trust Proxy settings <a class="header-anchor" href="#trust-proxy-settings" aria-label="Permalink to &quot;Trust Proxy settings&quot;">​</a></h3><ul><li>Default: When <code>PUBLIC_URL</code> is set and <code>TRUST_PROXY</code> is not, the app sets <code>trust proxy</code> to <code>loopback,uniquelocal</code>. This trusts only local/private reverse proxies (Docker/Traefik/Nginx on RFC1918/loopback ranges) and avoids the security risk of trusting arbitrary clients.</li><li>Override: Set <code>TRUST_PROXY</code> explicitly for your topology. Supported values: <ul><li><code>false</code> – disable trusting proxies (Express default).</li><li>A number (e.g. <code>1</code>, <code>2</code>) – trust that many hops in <code>X-Forwarded-For</code>.</li><li>A string list – e.g. <code>loopback,uniquelocal</code> or CIDRs/IPs like <code>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16</code>.</li></ul></li><li>Note: <code>TRUST_PROXY=true</code> is not accepted as-is; it is mapped to <code>loopback,uniquelocal</code> to prevent IP spoofing and satisfy <code>express-rate-limit</code> safety checks.</li></ul>`,11)])])}const u=s(t,[["render",l]]);export{k as __pageData,u as default};
